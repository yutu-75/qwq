"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[95470],{495470:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var l=a(150361),s=a.n(l),n=a(667294),i=a(164561),r=a(71577),o=a(519650),d=a(931097),c=a(560331),u=a(855241),m=a(432787),p=a(624225),Z=a(455867),h=a(431069),g=a(74401),C=a(205872),b=a.n(C),E=a(318933),y=a(818397),x=a(604942),T=a(211965);const A=[{type:"paragraph",children:[{text:""}]}],O=({value:e=A,setValue:t},a)=>{const l=(0,n.useCallback)((e=>(0,T.tZ)(S,e)),[]),s=(0,n.useMemo)((()=>k((0,x.BU)((0,y.VC)((0,E.Jh)())))),[]),i=(0,n.useCallback)(((e,t)=>{const a={type:"mention",character:e,children:[{text:t,bold:!0}]};E.YR.insertNodes(s,a),E.YR.move(s)}),[s]);return(0,n.useImperativeHandle)(a,(()=>({addNode:i}))),(0,T.tZ)(x.mH,{style:{heigt:"40px"},editor:s,initialValue:e,value:e,onChange:e=>{t(e)}},(0,T.tZ)(x.CX,{renderElement:l,placeholder:(0,Z.t)("Enter webpage link")}))},k=e=>{const{isInline:t,isVoid:a,markableVoid:l}=e;return e.isInline=e=>"mention"===e.type||t(e),e.isVoid=e=>"mention"===e.type||a(e),e.markableVoid=e=>"mention"===e.type||l(e),e},S=e=>{const{attributes:t,children:a,element:l}=e;return"mention"===l.type?(0,T.tZ)(f,e):(0,T.tZ)("p",t,a)},f=({attributes:e,children:t,element:a})=>{const l=(0,x.vt)(),s=(0,x.UE)(),n={padding:"3px 3px 2px",margin:"0 1px",verticalAlign:"baseline",display:"inline-block",borderRadius:"4px",backgroundColor:"#eee",fontSize:"0.9em",boxShadow:l&&s?"0 0 0 2px #B4D5FF":"none"};return a.children[0].bold&&(n.fontWeight="bold"),a.children[0].italic&&(n.fontStyle="italic"),(0,T.tZ)("span",b()({},e,{contentEditable:!1,"data-cy":`mention-${a.character.replace(" ","-")}`,style:n}),a.character,t)},P=(0,n.forwardRef)(O),I=[{label:(0,Z.t)("Name"),key:"name"},{label:(0,Z.t)("Account"),key:"username"},{label:(0,Z.t)("Email"),key:"email"}],v=()=>{const[e]=i.Z.useForm(),t=(0,n.useRef)(null),[a,l]=(0,n.useState)(1),[C,b]=(0,n.useState)(!1),[E,y]=(0,n.useState)("#000"),[x,A]=(0,n.useState)(null),[O,k]=(0,n.useState)([]),[S,f]=(0,n.useState)(""),[v,V]=(0,n.useState)([]),L=t=>{l(t),1==t&&(e.setFieldsValue({TEXT:x.original_text,COLOR:x.COLOR,SIZE:x.SIZE,OPACITY:x.OPACITY,SPACE:x.SPACE,ANGLE:x.ANGLE,status:x.status}),y(x.COLOR),R(x.original_text))};function N(){h.Z.get({endpoint:"/api/v2/sys/config?type=WATER_MARK"}).then((t=>{200==t.json.meta.code||201==t.json.meta.code?(e.setFieldsValue({TEXT:t.json.meta.data.original_text,COLOR:t.json.meta.data.COLOR,SIZE:t.json.meta.data.SIZE,OPACITY:t.json.meta.data.OPACITY,SPACE:t.json.meta.data.SPACE,ANGLE:t.json.meta.data.ANGLE,status:t.json.meta.data.status}),A(s()(t.json.meta.data)),y(t.json.meta.data.COLOR),R(t.json.meta.data.original_text)):message.error(t.json.meta.message)}))}(0,n.useEffect)((()=>{N()}),[]);const R=(e="")=>{const t=null==e?void 0:e.split("/#"),a=/^\$\{([\s\S]*?)\}$/,l=[];let s="";const n=[];null==t||t.forEach(((e,i)=>{if(a.test(e)){const r=e.substr(2,e.length-3),o=I.find((e=>e.key==r));o&&(l.push({character:o.label,type:"mention",children:[{bold:!0,text:o.key}]}),(0==i||a.test(t[i-1]))&&l.splice(i,0,{text:""}),i==t.length-1&&l.push({text:""}),s+=o.label,n.push(o.key))}else l.push({text:e}),s+=e})),k([{type:"paragraph",children:l}]),f(s),V(n)};(0,n.useEffect)((()=>{}),[O]);return(0,T.tZ)("div",{className:"content"},(0,T.tZ)("div",{className:"tabs3Top"},(0,T.tZ)("div",{className:"sunTitle"},(0,Z.t)("Watermark Settings")),(0,T.tZ)("div",null,(0,T.tZ)("span",null,1==a?(0,T.tZ)(r.Z,{type:"primary",onClick:()=>L(2)},(0,Z.t)("Edit")):(0,T.tZ)(o.Z,null,(0,T.tZ)(r.Z,{onClick:()=>L(1)},(0,Z.t)("Cancel")),(0,T.tZ)(r.Z,{type:"primary",loading:C,onClick:()=>{e.validateFields().then((t=>{if(t){b(!0);let t={param:{TEXT:e.getFieldValue().TEXT,COLOR:e.getFieldValue().COLOR,SIZE:e.getFieldValue().SIZE,OPACITY:e.getFieldValue().OPACITY,SPACE:e.getFieldValue().SPACE,ANGLE:e.getFieldValue().ANGLE},type:"WATER_MARK",status:!0};h.Z.put({endpoint:"/api/v2/sys/config/",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>{200==e.json.meta.code||201==e.json.meta.code?(N(),b(!1),l(1)):message.error(e.json.meta.message)}))}else b(!1)})).catch((()=>{b(!1)}))}},(0,Z.t)("Confirm")))))),(0,T.tZ)(i.Z,{form:e,layout:"vertical",autoComplete:"off",className:"scollercss"},(0,T.tZ)(i.Z.Item,{label:(0,Z.t)("Text"),name:"TEXT",rules:[{required:!0,message:(0,Z.t)("Please enter a text")}]},1==a?(0,T.tZ)("div",{className:"TEXT-view"},S):(0,T.tZ)("div",null,(0,T.tZ)("div",{className:"TEXT-source"},(0,T.tZ)("span",null,(0,Z.t)("Available values:")),I.map((e=>(0,T.tZ)(d.Z,{title:v.includes(e.key)?(0,Z.t)("Click to cancel"):(0,Z.t)("Click to add to input box")},(0,T.tZ)(c.Z.CheckableTag,{key:e.key,checked:v.includes(e.key),onChange:a=>((e,a)=>{var l;const s=a?[...v,e.key]:v.filter((t=>t!==e.key));V(s),null==(l=t.current)||l.addNode(e.label,e.key)})(e,a)},e.label))))),(0,T.tZ)("div",{className:"TEXT-editor"},(0,T.tZ)(P,{ref:t,style:{height:"100%",backgroundColor:"#fff"},value:O,setValue:t=>{let a="",l="";const s=[];t.forEach((e=>{"paragraph"===e.type&&e.children.forEach((e=>{"mention"===e.type?(a=`${a?a+"/#":""}\${${e.children[0].text}}`,l+=e.character,s.push(e.children[0].text)):e.text&&(a=`${a?a+"/#":""}${e.text}`,l+=e.text)}))})),e.setFieldsValue({TEXT:a,COLOR:e.getFieldValue().COLOR,SIZE:e.getFieldValue().SIZE,OPACITY:e.getFieldValue().OPACITY,SPACE:e.getFieldValue().SPACE,ANGLE:e.getFieldValue().ANGLE}),f(l),V(s)}})))),(0,T.tZ)(i.Z.Item,{label:(0,Z.t)("Text Color"),name:"COLOR",rules:[{required:!0,message:(0,Z.t)("Please enter a text color")}]},(0,T.tZ)(u.Z,{content:(0,T.tZ)(g.xS,{color:E,onChangeComplete:t=>{const{hex:a,rgb:{r:l,g:s,b:n,a:i}}=t,r=a;e.setFieldsValue({COLOR:r}),y(r)},presetColors:[],disableAlpha:!1}),trigger:"click",placement:"bottom"},(0,T.tZ)(m.Z,{disabled:1==a,placeholder:(0,Z.t)("Please enter a text color"),value:E}))),(0,T.tZ)(i.Z.Item,{label:(0,Z.t)("Text Size"),name:"SIZE",rules:[{required:!0,message:(0,Z.t)("Please enter a text size")}]},(0,T.tZ)(p.Z,{style:{width:"100%"},min:10,max:100,disabled:1==a,placeholder:(0,Z.t)("Please enter a text size")})),(0,T.tZ)(i.Z.Item,{label:(0,Z.t)("Opacity"),name:"OPACITY",rules:[{required:!0,message:(0,Z.t)("Please enter a opacity")}]},(0,T.tZ)(p.Z,{style:{width:"100%"},min:0,max:1,step:.1,disabled:1==a,placeholder:(0,Z.t)("Please enter a opacity")})),(0,T.tZ)(i.Z.Item,{label:(0,Z.t)("Space"),name:"SPACE",rules:[{required:!0,message:(0,Z.t)("Please enter a space")}]},(0,T.tZ)(p.Z,{style:{width:"100%"},min:0,max:9999,disabled:1==a,placeholder:(0,Z.t)("Please enter a space")})),(0,T.tZ)(i.Z.Item,{label:(0,Z.t)("Angle"),name:"ANGLE",rules:[{required:!0,message:(0,Z.t)("Please enter a angle")}]},(0,T.tZ)(p.Z,{style:{width:"100%"},min:0,max:360,disabled:1==a,placeholder:(0,Z.t)("Please enter a angle")}))))}}}]);