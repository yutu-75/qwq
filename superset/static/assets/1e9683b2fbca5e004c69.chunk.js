"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[32229],{67869:(e,t,n)=>{n.d(t,{E8:()=>T,CW:()=>d.Z,kI:()=>r,A5:()=>i.Z,Gz:()=>u.Z,Ys:()=>p.Z,$5:()=>m.Z,Dg:()=>f.Z,XF:()=>y.Z,gE:()=>o.Z,yE:()=>g.Z,eL:()=>s.Z,zR:()=>h.Z,UM:()=>v.Z,Bs:()=>x.Z,T8:()=>c.Z,Xs:()=>Z.Xs,Ag:()=>Z.Ag,Zf:()=>b.Zf,Gh:()=>b.Gh,B_:()=>a.Z,Qg:()=>b.Qg,j3:()=>l.Z,l:()=>Z.ZP,xG:()=>b.xG,oo:()=>b.oo,vq:()=>b.vq});var r=n(328062),i=n(997466),o=n(815226),a=n(281545),s=n(758586),l=n(45511),c=n(902995),h=n(598195),d=n(727965),u=n(786698),p=n(269224),m=n(977781),f=n(364236),y=n(765445),g=n(836361),v=n(132),x=n(231225),b=n(25130),Z=n(478161);const T="#00A699"},208608:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(662761);function i(e,t,n){let r=e,i=t(r);for(;!n(i);){if(r-=1,r<0){r=e;break}i=t(r)}return r}function o(e){const{idealFontSize:t,maxWidth:n,maxHeight:o,style:a,...s}=e;let l;if(void 0!==t&&null!==t)l=t;else{if(void 0===o||null===o)throw new Error("You must specify at least one of maxHeight or idealFontSize");l=Math.floor(o)}function c(e){return(0,r.Z)({...s,style:{...a,fontSize:`${e}px`}})}return void 0!==n&&null!==n&&(l=i(l,c,(e=>e.width>0&&e.width<=n))),void 0!==o&&null!==o&&(l=i(l,c,(e=>e.height>0&&e.height<=o))),l}},662761:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(610660),i=n(161888),o=n(791572);function a(e,t){const{text:n,className:a,style:s,container:l}=e;if(0===n.length)return{height:0,width:0};const c=o.Y.createInContainer(l),h=o.S.createInContainer(c);(0,r.Z)(h,{className:a,style:s,text:n});const d=(0,i.Z)(h,t);return setTimeout((()=>{o.S.removeFromContainer(c),o.Y.removeFromContainer(l)}),500),d}},204470:(e,t,n)=>{n.d(t,{Z:()=>r});class r{constructor(e){this.activeNodes=new Map,this.factoryFn=void 0,this.factoryFn=e}createInContainer(e=document.body){if(this.activeNodes.has(e)){const t=this.activeNodes.get(e);return t.counter+=1,t.node}const t=this.factoryFn();return e.append(t),this.activeNodes.set(e,{counter:1,node:t}),t}removeFromContainer(e=document.body){if(this.activeNodes.has(e)){const t=this.activeNodes.get(e);t.counter-=1,0===t.counter&&(e.removeChild(t.node),this.activeNodes.delete(e))}}}},248691:(e,t,n)=>{n.d(t,{h:()=>r});const r="http://www.w3.org/2000/svg"},524313:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(248691);function i(){const e=document.createElementNS(r.h,"svg");return e.style.position="absolute",e.style.top="-100%",e.style.left="-100%",e.style.width="0",e.style.height="0",e.style.opacity="0",e.style.pointerEvents="none",e}},748e3:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(248691);function i(){return document.createElementNS(r.h,"text")}},791572:(e,t,n)=>{n.d(t,{S:()=>s,Y:()=>a});var r=n(204470),i=n(524313),o=n(748e3);const a=new r.Z(i.Z),s=new r.Z(o.Z)},161888:(e,t,n)=>{n.d(t,{Z:()=>i});const r={height:20,width:100};function i(e,t=r){const{width:n,height:i}=e.getBBox?e.getBBox():t;return{height:Math.ceil(i),width:Math.ceil(n)}}},610660:(e,t,n)=>{n.d(t,{Z:()=>i});const r=["font","fontWeight","fontStyle","fontSize","fontFamily","letterSpacing"];function i(e,{className:t,style:n={},text:i}={}){const o=e;return o.textContent!==i&&(o.textContent="undefined"===typeof i?null:i),o.getAttribute("class")!==t&&o.setAttribute("class",null!=t?t:""),o.style.removeProperty("font"),o.style.removeProperty("font-weight"),o.style.removeProperty("font-style"),o.style.removeProperty("font-size"),o.style.removeProperty("font-family"),o.style.removeProperty("letter-spacing"),r.filter((e=>"undefined"!==typeof n[e]&&null!==n[e])).forEach((e=>{o.style[e]=`${n[e]}`})),o}},332229:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(667294),i=n(767190),o=n(455867),a=n(208608),s=n(740962),l=n(67869),c=n(751995),h=n(338575),d=n(789549),u=n(263475),p=n(353236),m=n(211965);const f=(0,i.JB)(),y=.08,g=.15,v=.1,x=.2,b=.1,Z=.1;class T extends r.PureComponent{constructor(...e){super(...e),this.state={initHeight:this.props.height}}getClassName(){const{className:e,showTrendLine:t,bigNumberFallback:n}=this.props,r=`superset-legacy-chart-big-number ${e} ${n?"is-fallback-value":""}`;return t?r:`${r} no-trendline`}createTemporaryContainer(){const e=document.createElement("div");return e.className=this.getClassName(),e.style.position="absolute",e.style.opacity="0",e}renderFallbackWarning(){const{bigNumberFallback:e,formatTime:t,showTimestamp:n}=this.props;return t&&e&&!n?(0,m.tZ)("span",{className:"alert alert-warning",role:"alert",title:(0,o.t)("Last available value seen on %s",t(e[0]))},(0,o.t)("Not up to date")):null}renderKicker(e){const{timestamp:t,showTimestamp:n,formatTime:r,width:i}=this.props;if(!r||!n||"string"===typeof t||"boolean"===typeof t)return null;const o=null===t?"":r(t),s=this.createTemporaryContainer();document.body.append(s);const l=(0,a.Z)({text:o,maxWidth:i,maxHeight:e,className:"kicker",container:s});return s.remove(),(0,m.tZ)("div",{className:"kicker",style:{fontSize:l,height:e}},o)}renderHeader(e){const{bigNumber:t,headerFormatter:n,width:i,mainColor:s,vizType:l,fontType:c,conditionalFormatting:u}=this.props,{headerPreText:p,headerFixText:f}=this.props,y=null===t?(0,o.t)("No data"):n(t),{icon:g,iconColorSchema:v,textColorSchema:x,colorScheme:b}=((e,t)=>{if(!t)return null;const n=t.filter((t=>{const{targetValue:n=0,targetValueLeft:r=0,targetValueRight:i=0}=t;switch(t.operator){case h.O9.EQUAL:return e==n;case h.O9.NOT_EQUAL:return e!=n;case h.O9.LESS_THAN:return e<n;case h.O9.LESS_OR_EQUAL:return e<=n;case h.O9.GREATER_THAN:return e>n;case h.O9.GREATER_OR_EQUAL:return e>=n;case h.O9.BETWEEN:return e>r&&e<i;case h.O9.BETWEEN_OR_EQUAL:return e>=r&&e<=i;case h.O9.BETWEEN_OR_LEFT_EQUAL:return e>=r&&e<i;case h.O9.BETWEEN_OR_RIGHT_EQUAL:return e>r&&e<=i;default:return!1}})),r=n.length;return r?n[r-1]:null})(t,u)||{},Z="big_number_total"===l?{color:x||s,fontFamily:c,background:b||"none"}:{},T=this.createTemporaryContainer();document.body.append(T);const w=(0,a.Z)({text:y,maxWidth:i-8,maxHeight:e,className:"header-line",container:T});T.remove();const E={display:"inline-flex",color:v,fontSize:.25*w+"px",paddingBottom:.1137*w+"px"},N=(0,m.tZ)("span",{style:{whiteSpace:"nowrap"}},p,y,f,g?(0,m.tZ)(r.Fragment,null,"\xa0",(0,m.tZ)(d.k,{type:g,style:E})):null);return(0,m.tZ)("div",{className:"header-line",style:{fontSize:w,height:e,...Z},onContextMenu:e=>{this.props.onContextMenu&&(e.preventDefault(),this.props.onContextMenu(e.nativeEvent.clientX,e.nativeEvent.clientY))}},N)}renderSubheader(e){const{bigNumber:t,subheader:n,width:r,bigNumberFallback:i}=this.props;let s=0;const l=(0,o.t)("No data after filtering or data is NULL for the latest time record"),c=(0,o.t)("Try applying different filters or ensuring your datasource has data");let h=n;if(null===t&&(h=i?c:l),h){const t=this.createTemporaryContainer();return document.body.append(t),s=(0,a.Z)({text:h,maxWidth:r,maxHeight:e,className:"subheader-line",container:t}),t.remove(),(0,m.tZ)("div",{className:"subheader-line",style:{fontSize:s,height:e}},h)}return null}renderTrendline(e){const{width:t,trendLineData:n,echartOptions:r,refs:i}=this.props;if(null==n||!n.some((e=>null!==e[1])))return null;const o={contextmenu:e=>{if(this.props.onContextMenu){e.event.stop();const{data:o}=e;if(o){var t,n,r,i;const a=e.event.event,s=[];s.push({col:null==(t=this.props.formData)?void 0:t.granularitySqla,grain:null==(n=this.props.formData)?void 0:n.timeGrainSqla,op:"==",val:o[0],formattedVal:null==(r=(i=this.props).xValueFormatter)?void 0:r.call(i,o[0])}),this.props.onContextMenu(a.clientX,a.clientY,s)}}}};return r&&(0,m.tZ)(u.Z,{refs:i,width:Math.floor(t),height:e,echartOptions:r,eventHandlers:o})}renderQoqText(e){var t;const{showQoqCal:n,qoqTypeChoose:r,qoqColorPicker:i,qoqIconFlagColorInvert:o,qoqIconFlag:s=1,qoqIconFixText:l,qoqYoy:c,width:h}=this.props;if(!n)return null;const{qoqRate:d,qoqValue:u}=c,f=1===r?d:u,{r:y=0,g=0,b:v=0,a:x=0}=i||{},b=(null==(t=(0,p.Ts)())?void 0:t.filter((e=>(null==e?void 0:e.value)===s))[0])||{};let Z=null,T=0;const w=this.createTemporaryContainer();return document.body.append(w),T=(0,a.Z)({text:f,maxWidth:h,maxHeight:e,className:"subheader-line",container:w}),w.remove(),Z=f>0?b.up_icon(o?p.hT:p.Gy,T):0===f?b.eq_icon(p.s6,T):b.down_icon(o?p.Gy:p.hT,T),(0,m.tZ)("div",{style:{display:"flex",alignItems:"center",color:`rgba(${y}, ${g}, ${v}, ${x})`}},(0,m.tZ)("div",{style:{fontSize:T}},"\u73af\u6bd4"),(0,m.tZ)("div",null,Z),(0,m.tZ)("div",{style:{fontSize:T}},f),(0,m.tZ)("div",{style:{fontSize:T}},l))}renderYoyText(e){var t;const{showYoyCal:n,yoyTypeChoose:r,yoyColorPicker:i,yoyIconFlagColorInvert:o,yoyIconFlag:s=1,yoyIconFixText:l,qoqYoy:c,width:h}=this.props;if(!n)return null;const{yoyRate:d,yoyValue:u}=c,f=1===r?d:u,{r:y=0,g=0,b:v=0,a:x=0}=i||{},b=(null==(t=(0,p.Ts)())?void 0:t.filter((e=>(null==e?void 0:e.value)===s))[0])||{};let Z=null,T=0;const w=this.createTemporaryContainer();return document.body.append(w),T=(0,a.Z)({text:f,maxWidth:h,maxHeight:e,className:"subheader-line",container:w}),Z=f>0?b.up_icon(o?p.hT:p.Gy,T):0===f?b.eq_icon(p.s6,T):b.down_icon(o?p.Gy:p.hT,T),(0,m.tZ)("div",{style:{display:"flex",alignItems:"center",color:`rgba(${y}, ${g}, ${v}, ${x})`}},(0,m.tZ)("div",{style:{fontSize:T}},"\u540c\u6bd4"),(0,m.tZ)("div",null,Z),(0,m.tZ)("div",{style:{fontSize:T}},f),(0,m.tZ)("div",{style:{fontSize:T}},l))}render(){const{showTrendLine:e,height:t,kickerFontSize:n,headerFontSize:r,subheaderFontSize:i,qoqFontSize:o=p.dB,yoyFontSize:a=p.dB}=this.props,s=this.getClassName();if(e){const e=Math.floor(x*t),l=t-e;return(0,m.tZ)("div",{className:s},(0,m.tZ)("div",{className:"text-container",style:{height:l}},this.renderFallbackWarning(),this.renderKicker(Math.ceil((n||0)*(1-x)*t)),this.renderHeader(Math.ceil(r/this.state.initHeight*(1-x)*t)),this.renderQoqText(Math.ceil(o/this.state.initHeight*(1-b)*t)),this.renderYoyText(Math.ceil(a/this.state.initHeight*(1-Z)*t)),this.renderSubheader(Math.ceil(i/this.state.initHeight*(1-x)*t))),this.renderTrendline(e))}return(0,m.tZ)("div",{className:s,style:{height:t}},this.renderFallbackWarning(),this.renderKicker((n||0)*t),this.renderHeader(Math.ceil(r/this.state.initHeight*t)),this.renderQoqText(Math.ceil(o/this.state.initHeight*(1-b)*t)),this.renderYoyText(Math.ceil(a/this.state.initHeight*(1-Z)*t)),this.renderSubheader(Math.ceil(i/this.state.initHeight*t)))}}T.defaultProps={className:"",headerFormatter:f,formatTime:s.Z,headerFontSize:g,kickerFontSize:y,mainColor:l.E8,vizType:"",showTimestamp:!1,showTrendLine:!1,startYAxisAtZero:!0,subheader:"",subheaderFontSize:v,timeRangeFixed:!1};const w=(0,c.iK)(T)`
  ${({theme:e})=>`\n    font-family: ${e.typography.families.sansSerif};\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: flex-start;\n\n    &.no-trendline .subheader-line {\n      padding-bottom: 0.3em;\n    }\n\n    .text-container {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: flex-start;\n      .alert {\n        font-size: ${e.typography.sizes.s};\n        margin: -0.5em 0 0.4em;\n        line-height: 1;\n        padding: ${e.gridUnit}px;\n        border-radius: ${e.gridUnit}px;\n      }\n    }\n\n    .kicker {\n      line-height: 1em;\n      padding-bottom: 2em;\n    }\n\n    .header-line {\n      position: relative;\n      line-height: 1em;\n      span {\n        position: absolute;\n        bottom: 0;\n      }\n    }\n\n    .subheader-line {\n      line-height: 1em;\n      padding-bottom: 0;\n    }\n\n    &.is-fallback-value {\n      .kicker,\n      .header-line,\n      .subheader-line {\n        opacity: ${e.opacity.mediumHeavy};\n      }\n    }\n  `}
`},263475:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(667294),i=n(751995),o=n(53552),a=n(211965);const s=i.iK.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function l({width:e,height:t,echartOptions:n,eventHandlers:i,zrEventHandlers:l,selectedValues:c={},refs:h},d){const u=(0,r.useRef)(null);h&&(h.divRef=u);const p=(0,r.useRef)(),m=(0,r.useMemo)((()=>Object.keys(c)||[]),[c]),f=(0,r.useRef)([]);(0,r.useImperativeHandle)(d,(()=>({getEchartInstance:()=>p.current}))),(0,r.useEffect)((()=>{u.current&&(p.current||(p.current=(0,o.S1)(u.current)),Object.entries(i||{}).forEach((([e,t])=>{var n,r;null==(n=p.current)||n.off(e),null==(r=p.current)||r.on(e,t)})),Object.entries(l||{}).forEach((([e,t])=>{var n,r;null==(n=p.current)||n.getZr().off(e),null==(r=p.current)||r.getZr().on(e,t)})),p.current.setOption(n,!0))}),[n,i,l]),(0,r.useEffect)((()=>{p.current&&(p.current.dispatchAction({type:"downplay",dataIndex:f.current.filter((e=>!m.includes(e)))}),m.length&&p.current.dispatchAction({type:"highlight",dataIndex:m}),p.current.dispatchAction({type:"hideTip"}),f.current=m)}),[m]);const y=(0,r.useCallback)((({width:e,height:t})=>{p.current&&p.current.resize({width:e,height:t})}),[]);return(0,r.useEffect)((()=>{if(!p.current)return;const e=()=>{p.current&&p.current.dispatchAction({type:"hideTip"})};return window.addEventListener("message",(t=>{"share-page-scroll"===t.data.type&&e()})),()=>{window.removeEventListener("message",e)}}),[p.current]),(0,r.useEffect)((()=>(y({width:e,height:t}),()=>{var e;return null==(e=p.current)?void 0:e.dispose()})),[]),(0,r.useLayoutEffect)((()=>{y({width:e,height:t})}),[e,t,y]),(0,a.tZ)(s,{ref:u,height:t,width:e})}const c=(0,r.forwardRef)(l)}}]);