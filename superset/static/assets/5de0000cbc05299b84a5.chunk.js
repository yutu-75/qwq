"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[31611],{452630:(t,e,a)=>{e.iB=e.YM=void 0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},o=l(a(667294)),r=l(a(45697)),i=a(402371);function l(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e,a){return function(r){var i,l,s,d=t[r.type],u=(l=(i=r).value,s=i.isDisabled,function(){!s&&a&&e!==l&&a(l)});return o.default.createElement(d,n({onClick:u},r))}};e.YM=function(t){var e=t.itemTypeToComponent,a=t.WrapperComponent,l=void 0===a?"div":a,d=function(t){var a=t.currentPage,r=t.totalPages,d=t.boundaryPagesRange,u=t.siblingPagesRange,c=t.hideEllipsis,g=t.hidePreviousAndNextPageLinks,h=t.hideFirstAndLastPageLinks,m=t.onChange,p=t.disabled,P=function(t,e){var a={};for(var n in t)e.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(t,n)&&(a[n]=t[n]);return a}(t,["currentPage","totalPages","boundaryPagesRange","siblingPagesRange","hideEllipsis","hidePreviousAndNextPageLinks","hideFirstAndLastPageLinks","onChange","disabled"]),_=(0,i.getPaginationModel)({currentPage:a,totalPages:r,boundaryPagesRange:d,siblingPagesRange:u,hideEllipsis:c,hidePreviousAndNextPageLinks:g,hideFirstAndLastPageLinks:h}),E=s(e,a,m);return o.default.createElement(l,P,_.map((function(t){return E(n({},t,{isDisabled:!!p}))})))};return d.propTypes={currentPage:r.default.number.isRequired,totalPages:r.default.number.isRequired,boundaryPagesRange:r.default.number,siblingPagesRange:r.default.number,hideEllipsis:r.default.bool,hidePreviousAndNextPageLinks:r.default.bool,hideFirstAndLastPageLinks:r.default.bool,onChange:r.default.func,disabled:r.default.bool},d},e.iB=i.ITEM_TYPES},129848:(t,e,a)=>{a.d(e,{Z:()=>d});a(667294);var n=a(751995),o=a(358593),r=a(731293),i=a(211965);const l=n.iK.span`
  white-space: nowrap;
  min-width: 100px;
  svg,
  i {
    margin-right: 8px;

    &:hover {
      path {
        fill: ${({theme:t})=>t.colors.primary.base};
      }
    }
  }
`,s=n.iK.span`
  color: ${({theme:t})=>t.colors.grayscale.base};
`;function d({actions:t}){return(0,i.tZ)(l,{className:"actions"},t.map(((t,e)=>{const a=r.Z[t.icon];return t.tooltip?(0,i.tZ)(o.u,{id:`${t.label}-tooltip`,title:t.tooltip,placement:t.placement,key:e},(0,i.tZ)(s,{role:"button",tabIndex:0,className:"action-button","data-test":t.label,onClick:t.onClick},(0,i.tZ)(a,null))):(0,i.tZ)(s,{role:"button",tabIndex:0,className:"action-button",onClick:t.onClick,"data-test":t.label,key:e},(0,i.tZ)(a,null))})))}},835276:(t,e,a)=>{a.r(e),a.d(e,{default:()=>x});var n=a(667294),o=a(616550),r=a(473727),i=a(751995),l=a(211965),s=a(455867),d=a(431069),u=a(730381),c=a.n(u),g=a(115926),h=a.n(g),m=a(667496),p=a(129848),P=a(419259),_=a(217198),E=a(418782),b=a(620755),f=a(998286),v=a(414114),y=a(34858),S=a(440768),L=a(662276),I=a(731293),T=a(774069),A=a(794670);const N=i.iK.div`
  margin: ${({theme:t})=>2*t.gridUnit}px auto
    ${({theme:t})=>4*t.gridUnit}px auto;
`,Z=(0,i.iK)(A.Ad)`
  border-radius: ${({theme:t})=>t.borderRadius}px;
  border: 1px solid ${({theme:t})=>t.colors.secondary.light2};
`,k=i.iK.div`
  margin-bottom: ${({theme:t})=>5*t.gridUnit}px;

  .control-label {
    margin-bottom: ${({theme:t})=>2*t.gridUnit}px;
  }

  .required {
    margin-left: ${({theme:t})=>t.gridUnit/2}px;
    color: ${({theme:t})=>t.colors.error.base};
  }

  textarea {
    flex: 1 1 auto;
    height: ${({theme:t})=>17*t.gridUnit}px;
    resize: none;
    width: 100%;
  }

  textarea,
  input[type='text'] {
    padding: ${({theme:t})=>1.5*t.gridUnit}px
      ${({theme:t})=>2*t.gridUnit}px;
    border: 1px solid ${({theme:t})=>t.colors.grayscale.light2};
    border-radius: ${({theme:t})=>t.gridUnit}px;
  }

  input[type='text'] {
    width: 65%;
  }
`,w=(0,v.ZP)((({addDangerToast:t,addSuccessToast:e,annotationLayerId:a,annotation:o=null,onAnnotationAdd:r,onHide:i,show:d})=>{var u,g;const[h,m]=(0,n.useState)(!0),[p,P]=(0,n.useState)(null),_=null!==o,{state:{loading:E,resource:b},fetchResource:f,createResource:v,updateResource:A}=(0,y.LE)(`annotation_layer/${a}/annotation`,(0,s.t)("annotation"),t),w=()=>{P({short_descr:"",start_dttm:"",end_dttm:"",json_metadata:"",long_descr:""})},M=()=>{_?P(b):w(),i()},x=t=>{const{target:e}=t,a={...p,end_dttm:p?p.end_dttm:"",short_descr:p?p.short_descr:"",start_dttm:p?p.start_dttm:""};a[e.name]=e.value,P(a)};return(0,n.useEffect)((()=>{if(_&&(!p||!p.id||o&&o.id!==p.id||d)){if(null!==(null==o?void 0:o.id)&&!E){const t=o.id||0;f(t)}}else _||p&&!p.id&&!d||w()}),[o]),(0,n.useEffect)((()=>{b&&P(b)}),[b]),(0,n.useEffect)((()=>{var t,e,a;null!=p&&null!=(t=p.short_descr)&&t.length&&null!=p&&null!=(e=p.start_dttm)&&e.length&&null!=p&&null!=(a=p.end_dttm)&&a.length?m(!1):m(!0)}),[p?p.short_descr:"",p?p.start_dttm:"",p?p.end_dttm:""]),(0,l.tZ)(T.Z,{disablePrimaryButton:h,onHandledPrimaryAction:()=>{if(_){if(null!=p&&p.id){const t=p.id;delete p.id,delete p.created_by,delete p.changed_by,delete p.changed_on_delta_humanized,delete p.layer,A(t,p).then((t=>{t&&(r&&r(),M(),e((0,s.t)("The annotation has been updated")))}))}}else p&&v(p).then((t=>{t&&(r&&r(),M(),e((0,s.t)("The annotation has been saved")))}))},onHide:M,primaryButtonName:_?(0,s.t)("Save"):(0,s.t)("Add"),show:d,width:"55%",title:(0,l.tZ)("h4",{"data-test":"annotation-modal-title"},_?(0,l.tZ)(I.Z.EditAlt,{css:S.xL}):(0,l.tZ)(I.Z.PlusLarge,{css:S.xL}),_?(0,s.t)("Edit annotation"):(0,s.t)("Add annotation"))},(0,l.tZ)(N,null,(0,l.tZ)("h4",null,(0,s.t)("Basic information"))),(0,l.tZ)(k,null,(0,l.tZ)("div",{className:"control-label"},(0,s.t)("Annotation name"),(0,l.tZ)("span",{className:"required"},"*")),(0,l.tZ)("input",{name:"short_descr",onChange:x,type:"text",value:null==p?void 0:p.short_descr})),(0,l.tZ)(k,null,(0,l.tZ)("div",{className:"control-label"},(0,s.t)("date"),(0,l.tZ)("span",{className:"required"},"*")),(0,l.tZ)(L.S,{placeholder:[(0,s.t)("Start date"),(0,s.t)("End date")],format:"YYYY-MM-DD HH:mm",onChange:(t,e)=>{const a={...p,end_dttm:p&&e[1].length?c()(e[1]).format("YYYY-MM-DD HH:mm"):"",short_descr:p?p.short_descr:"",start_dttm:p&&e[0].length?c()(e[0]).format("YYYY-MM-DD HH:mm"):""};P(a)},showTime:{format:"hh:mm a"},use12Hours:!0,value:null!=p&&null!=(u=p.start_dttm)&&u.length||null!=p&&null!=(g=p.end_dttm)&&g.length?[c()(p.start_dttm),c()(p.end_dttm)]:null})),(0,l.tZ)(N,null,(0,l.tZ)("h4",null,(0,s.t)("Additional information"))),(0,l.tZ)(k,null,(0,l.tZ)("div",{className:"control-label"},(0,s.t)("description")),(0,l.tZ)("textarea",{name:"long_descr",value:p?p.long_descr:"",placeholder:(0,s.t)("Description (this can be seen in the list)"),onChange:x})),(0,l.tZ)(k,null,(0,l.tZ)("div",{className:"control-label"},(0,s.t)("JSON metadata")),(0,l.tZ)(Z,{onChange:t=>{const e={...p,end_dttm:p?p.end_dttm:"",json_metadata:t,short_descr:p?p.short_descr:"",start_dttm:p?p.start_dttm:""};P(e)},value:null!=p&&p.json_metadata?p.json_metadata:"",width:"100%",height:"120px"})))})),M=i.iK.div`
  ${({theme:t})=>l.iv`
    display: flex;
    flex-direction: row;

    a,
    Link {
      margin-left: ${4*t.gridUnit}px;
      font-size: ${t.typography.sizes.s}px;
      font-weight: ${t.typography.weights.normal};
      text-decoration: underline;
    }
  `}
`;const x=(0,v.ZP)((function({addDangerToast:t,addSuccessToast:e}){const{annotationLayerId:a}=(0,o.UO)(),{state:{loading:i,resourceCount:u,resourceCollection:g,bulkSelectEnabled:v},fetchData:L,refreshData:I,toggleBulkSelect:T}=(0,y.Yi)(`annotation_layer/${a}/annotation`,(0,s.t)("annotation"),t,!1),[A,N]=(0,n.useState)(!1),[Z,k]=(0,n.useState)(""),[x,R]=(0,n.useState)(null),[K,Y]=(0,n.useState)(null),C=t=>{R(t),N(!0)},$=(0,n.useCallback)((async function(){try{const t=await d.Z.get({endpoint:`/api/v1/annotation_layer/${a}`});k(t.json.result.name)}catch(e){await(0,f.O$)(e).then((({error:e})=>{t(e.error||e.statusText||e)}))}}),[a]);(0,n.useEffect)((()=>{$()}),[$]);const D=[{id:"short_descr",desc:!0}],F=(0,n.useMemo)((()=>[{accessor:"short_descr",Header:(0,s.t)("Label")},{accessor:"long_descr",Header:(0,s.t)("Description")},{Cell:({row:{original:{start_dttm:t}}})=>c()(new Date(t)).format("ll"),Header:(0,s.t)("Start"),accessor:"start_dttm"},{Cell:({row:{original:{end_dttm:t}}})=>c()(new Date(t)).format("ll"),Header:(0,s.t)("End"),accessor:"end_dttm"},{Cell:({row:{original:t}})=>{const e=[{label:"edit-action",tooltip:(0,s.t)("Edit annotation"),placement:"bottom",icon:"Edit",onClick:()=>C(t)},{label:"delete-action",tooltip:(0,s.t)("Delete annotation"),placement:"bottom",icon:"Trash",onClick:()=>Y(t)}];return(0,l.tZ)(p.Z,{actions:e})},Header:(0,s.t)("Actions"),id:"actions",disableSortBy:!0}]),[!0,!0]),G=[];G.push({name:(0,l.tZ)(n.Fragment,null,(0,l.tZ)("i",{className:"fa fa-plus"})," ",(0,s.t)("Annotation")),buttonStyle:"primary",onClick:()=>{C(null)}}),G.push({name:(0,s.t)("Bulk select"),onClick:T,buttonStyle:"secondary","data-test":"annotation-bulk-select"});let U=!0;try{(0,o.k6)()}catch(t){U=!1}const H={title:(0,s.t)("No annotation yet"),image:"filter-results.svg",buttonAction:()=>{C(null)},buttonText:(0,l.tZ)(n.Fragment,null,(0,l.tZ)("i",{className:"fa fa-plus"})," ",(0,s.t)("Annotation"))};return(0,l.tZ)(n.Fragment,null,(0,l.tZ)(b.Z,{name:(0,l.tZ)(M,null,(0,l.tZ)("span",null,(0,s.t)("Annotation Layer %s",Z)),(0,l.tZ)("span",null,U?(0,l.tZ)(r.rU,{to:"/annotationlayer/list/"},(0,s.t)("Back to all")):(0,l.tZ)("a",{href:(0,m.VU)("/annotationlayer/list/")},(0,s.t)("Back to all")))),buttons:G}),(0,l.tZ)(w,{addDangerToast:t,addSuccessToast:e,annotation:x,show:A,onAnnotationAdd:()=>I(),annotationLayerId:a,onHide:()=>N(!1)}),K&&(0,l.tZ)(_.Z,{description:(0,s.t)("Are you sure you want to delete %s?",null==K?void 0:K.short_descr),onConfirm:()=>{K&&(({id:n,short_descr:o})=>{d.Z.delete({endpoint:`/api/v1/annotation_layer/${a}/annotation/${n}`}).then((()=>{I(),Y(null),e((0,s.t)("Deleted: %s",o))}),(0,S.v$)((e=>t((0,s.t)("There was an issue deleting %s: %s",o,e)))))})(K)},onHide:()=>Y(null),open:!0,title:(0,s.t)("Delete Annotation?")}),(0,l.tZ)(P.Z,{title:(0,s.t)("Please confirm"),description:(0,s.t)("Are you sure you want to delete the selected annotations?"),onConfirm:n=>{d.Z.delete({endpoint:`/api/v1/annotation_layer/${a}/annotation/?q=${h().encode(n.map((({id:t})=>t)))}`}).then((({json:t={}})=>{I(),e(t.message)}),(0,S.v$)((e=>t((0,s.t)("There was an issue deleting the selected annotations: %s",e)))))}},(t=>{const e=[{key:"delete",name:(0,s.t)("Delete"),onSelect:t,type:"danger"}];return(0,l.tZ)(E.Z,{className:"annotations-list-view",bulkActions:e,bulkSelectEnabled:v,columns:F,count:u,data:g,disableBulkSelect:T,emptyState:H,fetchData:L,initialSort:D,loading:i,pageSize:25})})))}))},656590:(t,e)=>{e.ITEM_TYPES={PAGE:"PAGE",ELLIPSIS:"ELLIPSIS",FIRST_PAGE_LINK:"FIRST_PAGE_LINK",PREVIOUS_PAGE_LINK:"PREVIOUS_PAGE_LINK",NEXT_PAGE_LINK:"NEXT_PAGE_LINK",LAST_PAGE_LINK:"LAST_PAGE_LINK"},e.ITEM_KEYS={FIRST_ELLIPSIS:-1,SECOND_ELLIPSIS:-2,FIRST_PAGE_LINK:-3,PREVIOUS_PAGE_LINK:-4,NEXT_PAGE_LINK:-5,LAST_PAGE_LINK:-6}},653804:(t,e,a)=>{var n=a(656590);e.createFirstEllipsis=function(t){return{type:n.ITEM_TYPES.ELLIPSIS,key:n.ITEM_KEYS.FIRST_ELLIPSIS,value:t,isActive:!1}},e.createSecondEllipsis=function(t){return{type:n.ITEM_TYPES.ELLIPSIS,key:n.ITEM_KEYS.SECOND_ELLIPSIS,value:t,isActive:!1}},e.createFirstPageLink=function(t){var e=t.currentPage;return{type:n.ITEM_TYPES.FIRST_PAGE_LINK,key:n.ITEM_KEYS.FIRST_PAGE_LINK,value:1,isActive:1===e}},e.createPreviousPageLink=function(t){var e=t.currentPage;return{type:n.ITEM_TYPES.PREVIOUS_PAGE_LINK,key:n.ITEM_KEYS.PREVIOUS_PAGE_LINK,value:Math.max(1,e-1),isActive:1===e}},e.createNextPageLink=function(t){var e=t.currentPage,a=t.totalPages;return{type:n.ITEM_TYPES.NEXT_PAGE_LINK,key:n.ITEM_KEYS.NEXT_PAGE_LINK,value:Math.min(a,e+1),isActive:e===a}},e.createLastPageLink=function(t){var e=t.currentPage,a=t.totalPages;return{type:n.ITEM_TYPES.LAST_PAGE_LINK,key:n.ITEM_KEYS.LAST_PAGE_LINK,value:a,isActive:e===a}},e.createPageFunctionFactory=function(t){var e=t.currentPage;return function(t){return{type:n.ITEM_TYPES.PAGE,key:t,value:t,isActive:t===e}}}},1158:(t,e)=>{e.createRange=function(t,e){for(var a=[],n=t;n<=e;n++)a.push(n);return a}},402371:(t,e,a)=>{var n=a(1158),o=a(653804);e.getPaginationModel=function(t){if(null==t)throw new Error("getPaginationModel(): options object should be a passed");var e=Number(t.totalPages);if(isNaN(e))throw new Error("getPaginationModel(): totalPages should be a number");if(e<0)throw new Error("getPaginationModel(): totalPages shouldn't be a negative number");var a=Number(t.currentPage);if(isNaN(a))throw new Error("getPaginationModel(): currentPage should be a number");if(a<0)throw new Error("getPaginationModel(): currentPage shouldn't be a negative number");if(a>e)throw new Error("getPaginationModel(): currentPage shouldn't be greater than totalPages");var r=null==t.boundaryPagesRange?1:Number(t.boundaryPagesRange);if(isNaN(r))throw new Error("getPaginationModel(): boundaryPagesRange should be a number");if(r<0)throw new Error("getPaginationModel(): boundaryPagesRange shouldn't be a negative number");var i=null==t.siblingPagesRange?1:Number(t.siblingPagesRange);if(isNaN(i))throw new Error("getPaginationModel(): siblingPagesRange should be a number");if(i<0)throw new Error("getPaginationModel(): siblingPagesRange shouldn't be a negative number");var l=Boolean(t.hidePreviousAndNextPageLinks),s=Boolean(t.hideFirstAndLastPageLinks),d=Boolean(t.hideEllipsis),u=d?0:1,c=[],g=o.createPageFunctionFactory(t);if(s||c.push(o.createFirstPageLink(t)),l||c.push(o.createPreviousPageLink(t)),1+2*u+2*i+2*r>=e){var h=n.createRange(1,e).map(g);c.push.apply(c,h)}else{var m=r,p=n.createRange(1,m).map(g),P=e+1-r,_=e,E=n.createRange(P,_).map(g),b=Math.min(Math.max(a-i,m+u+1),P-u-2*i-1),f=b+2*i,v=n.createRange(b,f).map(g);if(c.push.apply(c,p),!d){var y=b-1,S=(y===m+1?g:o.createFirstEllipsis)(y);c.push(S)}if(c.push.apply(c,v),!d){var L=f+1,I=(L===P-1?g:o.createSecondEllipsis)(L);c.push(I)}c.push.apply(c,E)}return l||c.push(o.createNextPageLink(t)),s||c.push(o.createLastPageLink(t)),c};var r=a(656590);e.ITEM_TYPES=r.ITEM_TYPES,e.ITEM_KEYS=r.ITEM_KEYS}}]);