"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[73942],{685931:(e,t,r)=>{r.d(t,{m:()=>l});var a=r(205872),n=r.n(a),o=(r(667294),r(473727)),i=r(23525),s=r(211965);const l=({to:e,component:t,replace:r,innerRef:a,children:l,...d})=>"string"===typeof e&&(0,i.TO)(e)?(0,s.tZ)("a",n()({"data-test":"external-link",href:(0,i.en)(e)},d),l):(0,s.tZ)(o.rU,n()({"data-test":"internal-link",to:e,component:t,replace:r,innerRef:a},d),l)},208911:(e,t,r)=>{r.d(t,{Z:()=>a});const a=(()=>{let e;try{e=r(Object(function(){var e=new Error("Cannot find module '../../../superset_text'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(t){e={}}return e})()},34858:(e,t,r)=>{r.d(t,{LE:()=>_,NE:()=>b,PW:()=>m,Yi:()=>g,_l:()=>R,cb:()=>E,fF:()=>y,h1:()=>x,jb:()=>C,rM:()=>$,xx:()=>w,z:()=>S});var a=r(115926),n=r.n(a),o=r(667294),i=r(431069),s=r(455867),l=r(522102),d=r(440768),c=(r(710222),r(998286)),u=r(208911),p=r(748086);const h=e=>"string"===typeof e?e:Object.entries(e).map((([e,t])=>Array.isArray(t)?`(${e}) ${t.join(", ")}`:`(${e}) ${t}`)).join("\n");function g(e,t,r,a=!0,l=[],c,u=!0){const[p,h]=(0,o.useState)({count:0,collection:l,loading:u,lastFetchDataConfig:null,permissions:[],bulkSelectEnabled:!1});function g(e){h((t=>({...t,...e})))}(0,o.useEffect)((()=>{a&&i.Z.get({endpoint:`/api/v1/${e}/_info?q=${n().encode({keys:["permissions"]})}`}).then((({json:e={}})=>{g({permissions:e.permissions})}),(0,d.v$)((e=>r((0,s.t)("An error occurred while fetching %s info: %s",t,e)))))}),[]);const _=(0,o.useCallback)((({pageIndex:a,pageSize:o,sortBy:l,filters:u})=>{var p,h,_,m;g({lastFetchDataConfig:{filters:u,pageIndex:a,pageSize:o,sortBy:l},loading:!0});const f=(c||[]).concat(u).map((({id:e,operator:t,value:r})=>({col:e,opr:t,value:r&&"object"===typeof r&&"value"in r?r.value:r}))),v=n().encode_uri({order_column:l[0].id,order_direction:l[0].desc?"desc":"asc",page:a,page_size:o,...f.length?{filters:f}:{}});let b="chart_is_favorite"==(null==(p=u[0])?void 0:p.operator)||"dashboard_is_favorite"==(null==(h=u[0])?void 0:h.operator),y="rel_m_m"==(null==(_=u[0])?void 0:_.operator)||"rel_m_m"==(null==(m=u[0])?void 0:m.operator);return"dashboard"==e||"chart"==e?i.Z.get({endpoint:`/api/v2/${e}/?limit=5&favorite=${b}&owner=${y}`}).then((({json:e={}})=>{g({collection:e.meta.data,count:5,lastFetched:(new Date).toISOString()})}),(0,d.v$)((e=>r((0,s.t)("An error occurred while fetching %ss: %s",t,e))))).finally((()=>{g({loading:!1})})):i.Z.get({endpoint:`/api/v1/${e}/?q=${v}`}).then((({json:e={}})=>{g({collection:e.result,count:e.count,lastFetched:(new Date).toISOString()})}),(0,d.v$)((e=>r((0,s.t)("An error occurred while fetching %ss: %s",t,e))))).finally((()=>{g({loading:!1})}))}),[c]);return{state:{loading:p.loading,resourceCount:p.count,resourceCollection:p.collection,bulkSelectEnabled:p.bulkSelectEnabled,lastFetched:p.lastFetched},setResourceCollection:e=>g({collection:e}),hasPerm:function(e){return!!p.permissions.length&&Boolean(p.permissions.find((t=>t===e)))},fetchData:_,toggleBulkSelect:function(){g({bulkSelectEnabled:!p.bulkSelectEnabled})},refreshData:e=>p.lastFetchDataConfig?_(p.lastFetchDataConfig):e?_(e):null}}function _(e,t,r){const[a,n]=(0,o.useState)({loading:!1,resource:null,error:null});function l(e){n((t=>({...t,...e})))}return{state:a,setResource:e=>l({resource:e}),fetchResource:(0,o.useCallback)((a=>(l({loading:!0}),i.Z.get({endpoint:`/api/v1/${e}/${a}`}).then((({json:e={}})=>(l({resource:e.result,error:null}),e.result)),(0,d.v$)((e=>{r((0,s.t)("An error occurred while fetching %ss: %s",t,h(e))),l({error:e})}))).finally((()=>{l({loading:!1})})))),[r,e,t]),createResource:(0,o.useCallback)(((a,n=!1)=>(l({loading:!0}),sessionStorage.getItem("newsqldatabaseid")?(a.sqlalchemy_uri&&(a.configuration_method="sqlalchemy_form"),i.Z.post({endpoint:"/api/v2/datasource/database/",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((({json:e={}})=>{if(200==e.meta.code||201==e.meta.code)return l({resource:{id:e.meta.data.id,...e.meta.data},error:null}),e.meta.data.id;p.ZP.error(e.meta.message)}),(0,d.v$)((e=>{n||r((0,s.t)("An error occurred while creating %ss: %s",t,h(e))),l({error:e})}))).finally((()=>{l({loading:!1})}))):i.Z.post({endpoint:`/api/v1/${e}/`,body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((({json:e={}})=>(l({resource:{id:e.id,...e.result},error:null}),e.id)),(0,d.v$)((e=>{n||r((0,s.t)("An error occurred while creating %ss: %s",t,h(e))),l({error:e})}))).finally((()=>{l({loading:!1})})))),[r,e,t]),updateResource:(0,o.useCallback)(((a,n,o=!1,c=!0)=>(c&&l({loading:!0}),i.Z.put({endpoint:`/api/v1/${e}/${a}`,body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((({json:e={}})=>(l({resource:{...e.result,id:e.id},error:null}),e.result)),(0,d.v$)((e=>(o||r((0,s.t)("An error occurred while fetching %ss: %s",t,JSON.stringify(e))),l({error:e}),e)))).finally((()=>{c&&l({loading:!1})})))),[r,e,t]),clearError:()=>l({error:null})}}function m(e,t,r){const[a,n]=(0,o.useState)({loading:!1,passwordsNeeded:[],alreadyExists:[],failed:!1});function l(e){n((t=>({...t,...e})))}return{state:a,importResource:(0,o.useCallback)(((a,n={},o=!1,u=null,p=null,h=null,g=null)=>{l({loading:!0,failed:!1});const _=new FormData;return _.append("formData",a),n&&_.append("passwords",JSON.stringify(n)),o&&_.append("overwrite","true"),u&&_.append("dataset_group_id",u),p&&_.append("datasource_group_id",p),h&&_.append("slice_group_id",h),g&&_.append("dash_group_id",g),i.Z.post({endpoint:`/api/v1/${e}/import/`,body:_,headers:{Accept:"application/json"}}).then((()=>(l({passwordsNeeded:[],alreadyExists:[],failed:!1}),!0))).catch((e=>(0,c.O$)(e).then((e=>(l({failed:!0}),e.errors?((0,d.Er)(e.errors)?r((0,s.t)("An error occurred while importing %s: %s",t,[...e.errors.map((e=>e.message)),(0,s.t)("Please re-export your file and try importing again")].join("\n"))):l({passwordsNeeded:(0,d.$u)(e.errors),alreadyExists:(0,d.cE)(e.errors)}),!1):(r((0,s.t)("An error occurred while importing %s: %s",t,e.message||e.error)),!1)))))).finally((()=>{l({loading:!1})}))}),[])}}var f;!function(e){e.CHART="slice",e.DASHBOARD="Dashboard"}(f||(f={}));const v={chart:(0,l.Z)({requestType:"rison",method:"GET",endpoint:"/api/v1/chart/favorite_status/"}),dashboard:(0,l.Z)({requestType:"rison",method:"GET",endpoint:"/api/v1/dashboard/favorite_status/"})};function b(e,t,r){const[a,n]=(0,o.useState)({}),l=e=>n((t=>({...t,...e})));(0,o.useEffect)((()=>{t.length&&v[e](t).then((({result:e})=>{const t=e.reduce(((e,t)=>(e[t.id]=t.value,e)),{});l(t)}),(0,d.v$)((e=>r((0,s.t)("There was an error fetching the favorite status: %s",e)))))}),[t,e,r]);return[(0,o.useCallback)(((t,a)=>{const n=a?"unselect":"select";i.Z.get({endpoint:`/superset/favstar/${"chart"===e?f.CHART:f.DASHBOARD}/${t}/${n}/`}).then((({json:e})=>{l({[t]:(null==e?void 0:e.count)>0})}),(0,d.v$)((e=>r((0,s.t)("There was an error saving the favorite status: %s",e)))))}),[e]),a]}const y=(e,t)=>{const[r,a]=(0,o.useState)(null);return{sliceCurrentlyEditing:r,handleChartUpdated:function(r){const a=t.map((e=>e.id===r.id?{...e,...r}:e));e(a)},openChartEditModal:function(e){a({slice_id:e.id,slice_name:e.slice_name,description:e.description,cache_timeout:e.cache_timeout,certified_by:e.certified_by,certification_details:e.certification_details,is_managed_externally:e.is_managed_externally})},closeChartEditModal:function(){a(null)}}},$=()=>u.Z.DB_IMAGES,C=()=>u.Z.DB_CONNECTION_ALERTS,S=()=>u.Z.DB_CONNECTION_DOC_LINKS,w=(e,t,r)=>{i.Z.post({endpoint:"api/v1/database/test_connection",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((()=>{r((0,s.t)("Connection looks good!"))}),(0,d.v$)((e=>{t((0,s.t)("ERROR: %s",h(e)))})))};function E(){const[e,t]=(0,o.useState)(null);return[e,(0,o.useCallback)((()=>{i.Z.get({endpoint:"/api/v1/database/available/"}).then((({json:e})=>{t(e)}))}),[t])]}function x(){const[e,t]=(0,o.useState)(null);return[e,(0,o.useCallback)(((e,r=!1)=>i.Z.post({endpoint:"/api/v1/database/validate_parameters/",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((()=>{t(null)})).catch((e=>{if("function"===typeof e.json)return e.json().then((({errors:e=[]})=>{const a=e.filter((e=>!["CONNECTION_MISSING_PARAMETERS_ERROR","CONNECTION_ACCESS_DENIED_ERROR"].includes(e.error_type)||r)).reduce(((e,{error_type:t,extra:r,message:a})=>{var n,o;return r.catalog?r.catalog.name?{...e,error_type:t,[r.catalog.idx]:{name:a}}:r.catalog.url?{...e,error_type:t,[r.catalog.idx]:{url:a}}:{...e,error_type:t,[r.catalog.idx]:{name:a,url:a}}:r.invalid?{...e,[r.invalid[0]]:a,error_type:t}:r.missing?{...e,error_type:t,...Object.assign({},...r.missing.map((e=>({[e]:(0,s.t)("This is a required field")}))))}:null!=(n=r.issue_codes)&&n.length?{...e,error_type:t,description:a||(null==(o=r.issue_codes[0])?void 0:o.message)}:e}),{});return t(a),a}))}))),[t]),t]}const R=(e,t,r)=>{var a;return r?null==(a=e.reports[t])?void 0:a[r]:{}}},400012:(e,t,r)=>{var a,n;r.d(t,{F:()=>a,J:()=>n}),function(e){e.Favorite="Favorite",e.Mine="Mine",e.Other="Other",e.Viewed="Viewed",e.Created="Created",e.Edited="Edited"}(a||(a={})),function(e){e.id="id",e.changed_on="changed_on",e.database="database",e.database_name="database.database_name",e.schema="schema",e.sql="sql",e.executed_sql="executed_sql",e.sql_tables="sql_tables",e.status="status",e.tab_name="tab_name",e.user="user",e.user_first_name="user.first_name",e.start_time="start_time",e.end_time="end_time",e.rows="rows",e.tmp_table_name="tmp_table_name",e.tracking_url="tracking_url"}(n||(n={}))},440768:(e,t,r)=>{r.d(t,{$u:()=>F,B1:()=>$,Er:()=>q,Gm:()=>x,IB:()=>O,IV:()=>v,Iu:()=>R,Ld:()=>y,Mc:()=>B,ZB:()=>Z,_L:()=>T,cE:()=>I,if:()=>M,iv:()=>j,mq:()=>D,tm:()=>S,v$:()=>E,wk:()=>w,xF:()=>C,xL:()=>N});var a=r(225325),n=r.n(a),o=r(431069),i=r(455867),s=r(68492),l=r(751995),d=r(211965),c=r(115926),u=r.n(c),p=r(998286),h=r(208911),g=r(212617),_=r(400012),m=r(581568);(()=>{const e=u(),t=[];for(let e=0;e<16;e+=1)for(let r=0;r<16;r+=1){if(e+r===0)continue;const a=String.fromCharCode(16*e+r);/\w|[-_./~]/.test(a)||t.push(`\\u00${e.toString(16)}${r.toString(16)}`)}e.not_idchar=t.join(""),e.not_idstart="-0123456789";const r=`[^${e.not_idstart}${e.not_idchar}][^${e.not_idchar}]*`;e.id_ok=new RegExp(`^${r}$`),e.next_id=new RegExp(r,"g")})();const f=e=>(t,r,a,n)=>async(a="",i,s)=>{var l;const d=`/api/v1/${t}/${e}/${r}`,c=u().encode_uri({filter:a,page:i,page_size:s}),{json:p={}}=await o.Z.get({endpoint:`${d}?q=${c}`});let h=!1;const g=n?{label:`${n.firstName} ${n.lastName}`,value:n.userId}:void 0,_=[];return null==p||null==(l=p.result)||l.filter((({text:e})=>e.trim().length>0)).forEach((({text:e,value:t})=>{g&&t===g.value&&e===g.label?h=!0:_.push({label:e,value:t})})),!g||a&&!h||_.unshift(g),{data:_,totalCount:null==p?void 0:p.count}},v=5,b=e=>{const t={order_column:"changed_on_delta_humanized",order_direction:"desc",page:0,page_size:v,filters:e};return e||delete t.filters,u().encode(t)},y=e=>{const t={edited:[{col:"changed_by",opr:"rel_o_m",value:`${e}`}]},r=[o.Z.get({endpoint:`/api/v1/dashboard/?q=${b(t.edited)}`}),o.Z.get({endpoint:`/api/v1/chart/?q=${b(t.edited)}`})];return Promise.all(r).then((([e,t])=>{var r,a;return{editedDash:null==(r=t.json)?void 0:r.result.slice(0,3),editedChart:null==(a=e.json)?void 0:a.result.slice(0,3)}})).catch((e=>e))},$=(e,t,r=[{col:"owners",opr:"rel_m_m",value:`${e}`}])=>o.Z.get({endpoint:`/api/v2/${t}/?limit=5`}).then((e=>{var t,r;return null==(t=e.json)||null==(r=t.meta)?void 0:r.data})),C=(e,t,r,a)=>o.Z.get({endpoint:t}).then((e=>{const t={},n=[o.Z.get({endpoint:`/api/v1/chart/?q=${b(a)}`}),o.Z.get({endpoint:`/api/v1/dashboard/?q=${b(a)}`})];return Promise.all(n).then((([r,a])=>(t.other=[...r.json.result,...a.json.result],t.viewed=e.json.result,t))).catch((e=>r((0,i.t)("There was an error fetching your recent activity:"),e)))})),S=f("related"),w=f("distinct");function E(e){return async t=>{const r=await(0,p.O$)(t),a=null==r?void 0:r.errors,n=await h.Z;null!=a&&a.length&&null!=n&&n.ERRORS&&a[0].error_type in n.ERRORS&&(r.message=n.ERRORS[a[0].error_type]),s.Z.error(t),e(r.message||r.error)}}function x({id:e,slice_name:t},r,a,n,s,l){const d={pageIndex:0,pageSize:v,sortBy:[{id:"changed_on_delta_humanized",desc:!0}],filters:[{id:"created_by",operator:"rel_o_m",value:`${l}`}]};o.Z.delete({endpoint:`/api/v1/chart/${e}`}).then((()=>{"Mine"===s?n(d):n(),r((0,i.t)("Deleted: %s",t))}),(()=>{a((0,i.t)("There was an issue deleting: %s",t))}))}function R({id:e,dashboard_title:t},r,a,n,s,l){return o.Z.delete({endpoint:`/api/v1/dashboard/${e}`}).then((()=>{"Mine"===s?r({pageIndex:0,pageSize:v,sortBy:[{id:"changed_on_delta_humanized",desc:!0}],filters:[{id:"owners",operator:"rel_m_m",value:`${l}`}]}):r(),a((0,i.t)("Deleted: %s",t))}),E((e=>n((0,i.t)("There was an issue deleting %s: %s",t,e)))))}function O(e,t){let r=e.split("\n");return r.length>=t&&(r=r.slice(0,t),r.push("...")),r.join("\n")}const j=5,D=[576,768,992,1200].map((e=>`@media (max-width: ${e}px)`)),T=l.iK.div`
  ${({showThumbnails:e,theme:t})=>`\n    overflow: hidden;\n    display: grid;\n    grid-gap: ${12*t.gridUnit}px ${4*t.gridUnit}px;\n    grid-template-columns: repeat(auto-fit, 300px);\n    max-height: ${e?"314":"148"}px;\n    margin-top: ${-6*t.gridUnit}px;\n    padding: ${e?`${8*t.gridUnit+3}px ${9*t.gridUnit}px`:`${8*t.gridUnit+1}px ${9*t.gridUnit}px`};\n  `}
`,Z=l.iK.div`
  cursor: pointer;
  a {
    text-decoration: none;
  }
  .ant-card-cover > div {
    /* Height is calculated based on 300px width, to keep the same aspect ratio as the 800*450 thumbnails */
    height: 168px;
  }
`,N=e=>d.iv`
  margin: auto ${2*e.gridUnit}px auto 0;
  color: ${e.colors.grayscale.base};
`,A=e=>"object"===typeof e&&Array.isArray(e._schema)&&1===e._schema.length&&"Must provide a password for the database"===e._schema[0],k=e=>"string"===typeof e&&e.includes("already exists and `overwrite=true` was not passed"),F=e=>e.map((e=>Object.entries(e.extra).filter((([,e])=>A(e))).map((([e])=>e)))).flat(),I=e=>e.map((e=>Object.entries(e.extra).filter((([,e])=>k(e))).map((([e])=>e)))).flat(),q=e=>e.some((e=>{const t=Object.entries(e.extra).filter((([e])=>"issue_codes"!==e));return 0===t.length||!t.every((([,e])=>A(e)||k(e)))})),U=(e,t)=>void 0!==e&&n()(e,t).length>0,B=(e,t,r,a,n)=>{const o=(0,g.R)("can_this_form_get","CsvToDatabaseView",e)&&U(t,n),i=U(r,n)&&(0,g.R)("can_this_form_get","ColumnarToDatabaseView",e),s=U(a,n)&&(0,g.R)("can_this_form_get","ExcelToDatabaseView",e);return{canUploadCSV:o,canUploadColumnar:i,canUploadExcel:s,canUploadData:o||i||s}};function M(e,t,r,a){return e===_.F.Created||t===m.g.SavedQueries&&e===_.F.Mine?[{id:"created_by",operator:"rel_o_m",value:`${null==r?void 0:r.userId}`}]:t===m.g.SavedQueries&&e===_.F.Favorite?[{id:"id",operator:"saved_query_is_fav",value:!0}]:e===_.F.Mine&&r?[{id:"owners",operator:"rel_m_m",value:`${r.userId}`}]:e===_.F.Favorite&&[m.g.Dashboards,m.g.Charts].includes(t)?[{id:"id",operator:t===m.g.Dashboards?"dashboard_is_favorite":"chart_is_favorite",value:!0}]:e===_.F.Other?(a||[]).map((e=>({id:e.col,operator:e.opr,value:e.value}))):[]}},581568:(e,t,r)=>{var a;r.d(t,{g:()=>a}),function(e){e.Charts="CHARTS",e.Dashboards="DASHBOARDS",e.Recents="RECENTS",e.SavedQueries="SAVED_QUERIES"}(a||(a={}))}}]);