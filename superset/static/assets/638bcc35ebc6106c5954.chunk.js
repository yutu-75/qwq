"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[88551],{941842:(e,t,n)=>{n.d(t,{Z:()=>i});n(667294);var r=n(925550),l=n(455867),a=n(211965);function i(e){const{listValueFilter:t,bcItemClick:n=(()=>{}),clearFilter:i=(()=>{}),styleCums:s={}}=e,o={position:"absolute",zIndex:1,...s};return(0,a.tZ)("div",{style:o},t.length>0&&(0,a.tZ)(r.Z,null,(0,a.tZ)(r.g,{onClick:()=>{i()}},(0,l.t)("Back to all")),t.map(((e,t)=>(0,a.tZ)(r.g,{onClick:()=>{n(e,t)}},e)))))}},925550:(e,t,n)=>{n.d(t,{Z:()=>s,g:()=>o});var r=n(205872),l=n.n(r),a=(n(667294),n(435247)),i=n(211965);const s=e=>(0,i.tZ)(a.Z,l()({},e,{css:e=>({".ant-breadcrumb-link":{cursor:"pointer"}})})),o=a.Z.Item},915872:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(667294),l=n(757016),a=n(751995),i=n(455867),s=n(683862),o=n(211965);const u=a.iK.div`
  ${({position:e})=>`\n    position: ${e.position};\n    left: ${e.left||0};\n    top: ${e.top||0};\n    z-index: 9999;\n    border: 1px #eee solid;\n\n\n    .ant-menu-submenu-active {\n      background: #5d9cec;\n    }\n\n    .ant-menu-submenu-active .ant-menu-submenu-title {\n      color: #ffffff;\n    }\n    \n    .ant-menu-submenu{\n      color:#000000 !important\n    }\n  `}
`,c=({position:e,showDiv:t,sliceJumpSetData:n=[],setShowDiv:a,clickProps:c,handleDrillingIn:d,handleProps:f})=>{const[h,p]=(0,r.useState)(!1),[m,g]=(0,r.useState)(""),[v,y]=(0,r.useState)(0),w=(e,t,l)=>(0,o.tZ)(r.Fragment,null,l?(0,o.tZ)(s.v2.SubMenu,{title:e,key:t,style:{color:"000"}},l.map(((e,t)=>w(e.name,`jump_${t}`)))):(0,o.tZ)(s.v2.Item,{key:t,onClick:e=>{(e=>{if(e.key.includes("jump")){const t=e.key.split("_"),r=n[t[1]];let l="";1===r.type&&(l=`${window.location.origin}/dashboard/list/?target_id=${r.config.treeValue}&standalone=true${r.config.list.map((e=>e.targetId?`&${e.targetId}=${c[e.sourceId.split("&&")[1]]?c[e.sourceId.split("&&")[1]]:""}`:"")).join("")}`),2===r.type&&r.config&&r.config.jumpUrl&&(l=r.config.jumpUrl.map((e=>e.children.map((e=>c[e.character]?c[e.character]:e.text||"")).join(""))).join("")),"1"===r.config.openType?window.open(l):(g(l),p(!0),a(!1))}else d&&d(f);a(!1)})(e)}},(0,i.t)(e)));return(0,r.useEffect)((()=>{n&&Array.isArray(n)?y(n.length):y(0)}),[n]),(0,r.useEffect)((()=>{document.addEventListener("click",(()=>{a(!1)}))}),[]),(0,o.tZ)(r.Fragment,null,t&&(0,o.tZ)(u,{position:e},(0,o.tZ)(s.v2,{"data-test":"menu-item-menu"},w("\u4e0b\u94bb","drilling_in"),v>0&&(0,o.tZ)(r.Fragment,null,v>1?w((0,i.t)("Jumo to"),"jump",n):w(`${(0,i.t)("Jumo to")}${n[0].name}`,"jump_0")))),(0,o.tZ)(l.Z,{title:null,closable:!1,visible:h,width:"95%",style:{top:20,height:"90vh"},footer:null,onCancel:()=>p(!1)},(0,o.tZ)("iframe",{src:m,title:"myIframe",width:"800",height:"750",frameborder:"0",scrolling:"yes",name:"myIframe",id:"myIframe",sandbox:"allow-scripts allow-same-origin"})))}},788551:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var r=n(150361),l=n.n(r),a=n(667294),i=n(753506),s=n(455867),o=n(616355),u=n(5364),c=n(828216),d=n(748086),f=n(941842),h=n(263475),p=n(806915),m=n(751995),g=n(510162),v=n(849239),y=n(211965);const{RadioButtonControl:w}=g.ZP,b=m.iK.div`
  text-align: center;
`;function Z({formData:e,setControlValue:t}){const{extraControlsOptions:n,extraControlsHandler:r,extraValue:l}=function({formData:e,setControlValue:t}){const{stack:n,area:r}=e,[l,i]=(0,a.useState)(null!=n?n:void 0);return(0,a.useEffect)((()=>{i(n)}),[n]),{extraControlsOptions:(0,a.useMemo)((()=>r?v.O0:[]),[r]),extraControlsHandler:(0,a.useCallback)((e=>{r&&t&&(t("stack",e),i(e))}),[r,t]),extraValue:l}}({formData:e,setControlValue:t});return e.showExtraControls?(0,y.tZ)(b,null,(0,y.tZ)(w,{options:n,onChange:r,value:l})):null}var S=n(915872);const C=300;function k({formData:e,height:t,width:n,echartOptions:r,groupby:m,labelMap:g,selectedValues:v,setDataMask:w,setControlValue:b,legendData:k=[],onContextMenu:x,xValueFormatter:I,xAxis:E,refs:D,emitCrossFilters:V}){const[A,O]=(0,a.useState)(!1),[$,j]=(0,a.useState)({}),[F,T]=(0,a.useState)({}),[R,J]=(0,a.useState)({}),{sliceJumpSetData:N,sliceJumpType:H}=(null==e?void 0:e.meta)||{},{stack:M,sliceId:P=0,enableChartDrilldown:_,drilldownColumns:z=[],vizType:L}=e,U=(0,a.useRef)(null);D.echartRef=U;const K=(0,a.useRef)(Date.now()),X=(0,a.useRef)(""),Y=(0,a.useRef)(),q=(0,a.useRef)(null),[B,G]=(0,a.useState)(0),W=(0,c.v9)((e=>e)),{dataMask:Q={}}=W,ee=(null==Q?void 0:Q[P])||{},{ownState:te={}}=ee,{listValueFilter:ne=[]}=te;(0,a.useEffect)((()=>{var e;const t=(null==(e=q.current)?void 0:e.offsetHeight)||0;G(t)}),[e.showExtraControls]),(0,a.useEffect)((()=>{w({ownState:{}})}),[JSON.stringify(e.xAxis),JSON.stringify(e.metrics),JSON.stringify(m),JSON.stringify(e.adhocFilters),_,JSON.stringify(z)]);const re=(0,a.useCallback)((e=>{var t;const n=null==(t=U.current)?void 0:t.getEchartInstance();e?k.forEach((t=>{t===e?(p.aI.legend=t,null==n||n.dispatchAction({type:"legendSelect",name:t})):null==n||n.dispatchAction({type:"legendUnSelect",name:t})})):(p.aI.legend="",null==n||n.dispatchAction({type:"legendAllSelect"}))}),[k]),le=(0,a.useCallback)((e=>{if(!V)return;const t=e.map((e=>g[e]));w({extraFormData:{filters:0===e.length?[]:m.map(((e,n)=>{const r=t.map((e=>e[n]));return null===r||void 0===r?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:r}}))},filterState:{label:t.length?t:void 0,value:t.length?t:null,selectedValues:e.length?e:null}})}),[m,g,w,V]),ae=e=>{Y.current&&clearTimeout(Y.current),Y.current=setTimeout((()=>{const{seriesName:t}=e,n=Object.values(v);n.includes(t)?le(n.filter((e=>e!==t))):le([t])}),C)},ie={click:t=>{if(t.name&&_&&(0,i.Z)(L)){const r=[null==e?void 0:e.xAxis,...m,...z];if(ne.length>=r.length-1)return void d.ZP.warning((0,s.t)("It has reached the deepest level"));const a=l()(ne);if(0===a.length){var n;a.push(t.name);const e=null==t||null==(n=t.seriesName)?void 0:n.split(", ");Array.isArray(e)&&m.length===e.length&&a.push(...e)}else a.push(t.name);w({ownState:{listValueFilter:a}})}else if("series"===t.componentType&&t.data&&N&&Array.isArray(N)&&N.length>0&&H){var r,a,o;j({position:"absolute",left:`${null==(r=t.event)?void 0:r.offsetX}px`,top:`${null==(a=t.event)?void 0:a.offsetY}px`});const n={};n[e.xAxis]=t.value[0],e.groupby&&e.groupby.forEach((e=>{n[e]=t.seriesId})),(null==e?void 0:e.metrics)&&(null==e||null==(o=e.metrics)||o.forEach((e=>{n[e.label]=t.data[1]}))),T(n),J(t),setTimeout((()=>{O(!0)}),0)}else ae(t)},mouseout:()=>{p.aI.name=""},mouseover:e=>{p.aI.name=e.seriesName},legendselectchanged:e=>{const t=Date.now();t-K.current<C&&X.current===e.name?re(e.name):(K.current=t,X.current=e.name),Object.values(e.selected).every((e=>!e))&&re()},contextmenu:t=>{if(x){t.event.stop();const{data:n}=t;if(n){const r=t.event.event,l=[...t.name?[t.name]:[],...g[t.seriesName]],a=[];E.type===o.we.time&&a.push({col:E.label===u.W3?e.granularitySqla:E.label,grain:e.timeGrainSqla,op:"==",val:n[0],formattedVal:I(n[0])}),[...E.type===o.we.category?[E.label]:[],...e.groupby].forEach(((e,t)=>a.push({col:e,op:"==",val:l[t],formattedVal:String(l[t])}))),x(r.clientX,r.clientY,a)}}}},se={dblclick:e=>{var t;Y.current&&clearTimeout(Y.current);const n=[e.offsetX,e.offsetY],r=null==(t=U.current)?void 0:t.getEchartInstance();if(null!=r&&r.containPixel("grid",n)){var l;if(!M&&"ec-polygon"===(null==(l=e.target)?void 0:l.type))return;const t=r.getModel(),n=((e,t)=>{let n=e,r=null;for(;n;){const e=n.__ecComponentInfo;if(null!=e){r=t.getComponent(e.mainType,e.index);break}n=n.parent}return r})(e.target,t),a=t.getSeriesCount(),i=t.getCurrentSeriesIndices();if(n){const{name:e}=n;a!==i.length?re():re(e)}}}};return(0,y.tZ)("div",{style:{position:"relative",width:n,height:t}},(0,y.tZ)(f.Z,{listValueFilter:ne,bcItemClick:(e,t)=>{const n=ne.filter(((e,n)=>n<=t));w({ownState:{listValueFilter:n}})},clearFilter:()=>{w({ownState:{}})}}),(0,y.tZ)("div",{ref:q},(0,y.tZ)(Z,{formData:e,setControlValue:b})),(0,y.tZ)(h.Z,{refs:D,height:t-B,width:n,echartOptions:r,eventHandlers:ie,zrEventHandlers:se,selectedValues:v}),(0,y.tZ)(S.Z,{position:$,showDiv:A,sliceJumpSetData:N,setShowDiv:O,clickProps:F,handleProps:R,handleDrillingIn:ae}))}},263475:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(667294),l=n(751995),a=n(53552),i=n(211965);const s=l.iK.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function o({width:e,height:t,echartOptions:n,eventHandlers:l,zrEventHandlers:o,selectedValues:u={},refs:c},d){const f=(0,r.useRef)(null);c&&(c.divRef=f);const h=(0,r.useRef)(),p=(0,r.useMemo)((()=>Object.keys(u)||[]),[u]),m=(0,r.useRef)([]);(0,r.useImperativeHandle)(d,(()=>({getEchartInstance:()=>h.current}))),(0,r.useEffect)((()=>{f.current&&(h.current||(h.current=(0,a.S1)(f.current)),Object.entries(l||{}).forEach((([e,t])=>{var n,r;null==(n=h.current)||n.off(e),null==(r=h.current)||r.on(e,t)})),Object.entries(o||{}).forEach((([e,t])=>{var n,r;null==(n=h.current)||n.getZr().off(e),null==(r=h.current)||r.getZr().on(e,t)})),h.current.setOption(n,!0))}),[n,l,o]),(0,r.useEffect)((()=>{h.current&&(h.current.dispatchAction({type:"downplay",dataIndex:m.current.filter((e=>!p.includes(e)))}),p.length&&h.current.dispatchAction({type:"highlight",dataIndex:p}),h.current.dispatchAction({type:"hideTip"}),m.current=p)}),[p]);const g=(0,r.useCallback)((({width:e,height:t})=>{h.current&&h.current.resize({width:e,height:t})}),[]);return(0,r.useEffect)((()=>{if(!h.current)return;const e=()=>{h.current&&h.current.dispatchAction({type:"hideTip"})};return window.addEventListener("message",(t=>{"share-page-scroll"===t.data.type&&e()})),()=>{window.removeEventListener("message",e)}}),[h.current]),(0,r.useEffect)((()=>(g({width:e,height:t}),()=>{var e;return null==(e=h.current)?void 0:e.dispose()})),[]),(0,r.useLayoutEffect)((()=>{g({width:e,height:t})}),[e,t,g]),(0,i.tZ)(s,{ref:f,height:t,width:e})}const u=(0,r.forwardRef)(o)}}]);