"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[64790],{941842:(e,t,n)=>{n.d(t,{Z:()=>s});n(667294);var r=n(925550),l=n(455867),i=n(211965);function s(e){const{listValueFilter:t,bcItemClick:n=(()=>{}),clearFilter:s=(()=>{}),styleCums:c={}}=e,a={position:"absolute",zIndex:1,...c};return(0,i.tZ)("div",{style:a},t.length>0&&(0,i.tZ)(r.Z,null,(0,i.tZ)(r.g,{onClick:()=>{s()}},(0,l.t)("Back to all")),t.map(((e,t)=>(0,i.tZ)(r.g,{onClick:()=>{n(e,t)}},e)))))}},925550:(e,t,n)=>{n.d(t,{Z:()=>c,g:()=>a});var r=n(205872),l=n.n(r),i=(n(667294),n(435247)),s=n(211965);const c=e=>(0,s.tZ)(i.Z,l()({},e,{css:e=>({".ant-breadcrumb-link":{cursor:"pointer"}})})),a=i.Z.Item},64790:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var r=n(150361),l=n.n(r),i=n(455867),s=n(667294),c=n(263475),a=n(849239),u=n(92638),o=n(828216),h=n(748086),d=n(941842),f=n(211965);function p({echartOptions:e,emitCrossFilters:t,groupby:n,height:r,labelMap:p,onContextMenu:g,refs:v,setDataMask:m,selectedValues:w,width:Z,formData:b}){const{enableChartDrilldown:I,drilldownColumns:k=[],sliceId:y=0}=b,C=(0,o.v9)((e=>e)),{dataMask:E={}}=C,O=(null==E?void 0:E[y])||{},{ownState:S={}}=O,{listValueFilter:F=[]}=S;(0,s.useEffect)((()=>{m({ownState:{}})}),[JSON.stringify(b.metrics),JSON.stringify(n),JSON.stringify(b.adhocFilters),I,JSON.stringify(k)]);const V=(0,s.useCallback)((e=>{if(!t)return;const r=e.map((e=>p[e]));m({extraFormData:{filters:0===e.length?[]:n.map(((e,t)=>{const n=r.map((e=>e[t]));return null===n||void 0===n?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:n}}))},filterState:{value:r.length?r:null,selectedValues:e.length?e:null}})}),[n,p,m,w]),x={click:e=>{const{data:t,treePathInfo:r}=e;if(e.name&&I){const e=[...n,...k];if(F.length>=e.length-1)return void h.ZP.warning((0,i.t)("It has reached the deepest level"));const t=l()(F),{treePath:s}=(0,u.Im)(r);return t.push(...s),void m({ownState:{listValueFilter:t}})}if(null!=t&&t.children)return;const{treePath:s}=(0,u.Im)(r),c=s.join(","),a=Object.values(w);a.includes(c)?V(a.filter((e=>e!==c))):V([c])},contextmenu:e=>{if(g){e.event.stop();const{treePath:t}=(0,u.Im)(e.treePathInfo);if(t.length>0){const r=e.event.event,l=[];t.forEach(((e,t)=>l.push({col:n[t],op:"==",val:"null"===e?a.li:e,formattedVal:e}))),g(r.clientX,r.clientY,l)}}}};return(0,f.tZ)(s.Fragment,null,(0,f.tZ)(d.Z,{listValueFilter:F,bcItemClick:(e,t)=>{const n=F.filter(((e,n)=>n<=t));m({ownState:{listValueFilter:n}})},clearFilter:()=>{m({ownState:{}})}}),(0,f.tZ)(c.Z,{refs:v,height:r,width:Z,echartOptions:e,eventHandlers:x,selectedValues:w}))}},263475:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(667294),l=n(751995),i=n(53552),s=n(211965);const c=l.iK.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function a({width:e,height:t,echartOptions:n,eventHandlers:l,zrEventHandlers:a,selectedValues:u={},refs:o},h){const d=(0,r.useRef)(null);o&&(o.divRef=d);const f=(0,r.useRef)(),p=(0,r.useMemo)((()=>Object.keys(u)||[]),[u]),g=(0,r.useRef)([]);(0,r.useImperativeHandle)(h,(()=>({getEchartInstance:()=>f.current}))),(0,r.useEffect)((()=>{d.current&&(f.current||(f.current=(0,i.S1)(d.current)),Object.entries(l||{}).forEach((([e,t])=>{var n,r;null==(n=f.current)||n.off(e),null==(r=f.current)||r.on(e,t)})),Object.entries(a||{}).forEach((([e,t])=>{var n,r;null==(n=f.current)||n.getZr().off(e),null==(r=f.current)||r.getZr().on(e,t)})),f.current.setOption(n,!0))}),[n,l,a]),(0,r.useEffect)((()=>{f.current&&(f.current.dispatchAction({type:"downplay",dataIndex:g.current.filter((e=>!p.includes(e)))}),p.length&&f.current.dispatchAction({type:"highlight",dataIndex:p}),f.current.dispatchAction({type:"hideTip"}),g.current=p)}),[p]);const v=(0,r.useCallback)((({width:e,height:t})=>{f.current&&f.current.resize({width:e,height:t})}),[]);return(0,r.useEffect)((()=>{if(!f.current)return;const e=()=>{f.current&&f.current.dispatchAction({type:"hideTip"})};return window.addEventListener("message",(t=>{"share-page-scroll"===t.data.type&&e()})),()=>{window.removeEventListener("message",e)}}),[f.current]),(0,r.useEffect)((()=>(v({width:e,height:t}),()=>{var e;return null==(e=f.current)?void 0:e.dispose()})),[]),(0,r.useLayoutEffect)((()=>{v({width:e,height:t})}),[e,t,v]),(0,s.tZ)(c,{ref:d,height:t,width:e})}const u=(0,r.forwardRef)(a)}}]);