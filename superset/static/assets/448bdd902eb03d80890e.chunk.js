"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[704],{915872:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(667294),i=n(757016),a=n(751995),s=n(455867),l=n(683862),o=n(211965);const u=a.iK.div`
  ${({position:e})=>`\n    position: ${e.position};\n    left: ${e.left||0};\n    top: ${e.top||0};\n    z-index: 9999;\n    border: 1px #eee solid;\n\n\n    .ant-menu-submenu-active {\n      background: #5d9cec;\n    }\n\n    .ant-menu-submenu-active .ant-menu-submenu-title {\n      color: #ffffff;\n    }\n    \n    .ant-menu-submenu{\n      color:#000000 !important\n    }\n  `}
`,c=({position:e,showDiv:t,sliceJumpSetData:n=[],setShowDiv:a,clickProps:c,handleDrillingIn:d,handleProps:p})=>{const[h,m]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),[v,w]=(0,r.useState)(0),y=(e,t,i)=>(0,o.tZ)(r.Fragment,null,i?(0,o.tZ)(l.v2.SubMenu,{title:e,key:t,style:{color:"000"}},i.map(((e,t)=>y(e.name,`jump_${t}`)))):(0,o.tZ)(l.v2.Item,{key:t,onClick:e=>{(e=>{if(e.key.includes("jump")){const t=e.key.split("_"),r=n[t[1]];let i="";1===r.type&&(i=`${window.location.origin}/dashboard/list/?target_id=${r.config.treeValue}&standalone=true${r.config.list.map((e=>e.targetId?`&${e.targetId}=${c[e.sourceId.split("&&")[1]]?c[e.sourceId.split("&&")[1]]:""}`:"")).join("")}`),2===r.type&&r.config&&r.config.jumpUrl&&(i=r.config.jumpUrl.map((e=>e.children.map((e=>c[e.character]?c[e.character]:e.text||"")).join(""))).join("")),"1"===r.config.openType?window.open(i):(g(i),m(!0),a(!1))}else d&&d(p);a(!1)})(e)}},(0,s.t)(e)));return(0,r.useEffect)((()=>{n&&Array.isArray(n)?w(n.length):w(0)}),[n]),(0,r.useEffect)((()=>{document.addEventListener("click",(()=>{a(!1)}))}),[]),(0,o.tZ)(r.Fragment,null,t&&(0,o.tZ)(u,{position:e},(0,o.tZ)(l.v2,{"data-test":"menu-item-menu"},y("\u4e0b\u94bb","drilling_in"),v>0&&(0,o.tZ)(r.Fragment,null,v>1?y((0,s.t)("Jumo to"),"jump",n):y(`${(0,s.t)("Jumo to")}${n[0].name}`,"jump_0")))),(0,o.tZ)(i.Z,{title:null,closable:!1,visible:h,width:"95%",style:{top:20,height:"90vh"},footer:null,onCancel:()=>m(!1)},(0,o.tZ)("iframe",{src:f,title:"myIframe",width:"800",height:"750",frameborder:"0",scrolling:"yes",name:"myIframe",id:"myIframe",sandbox:"allow-scripts allow-same-origin"})))}},500704:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(667294),i=n(616355),a=n(5364),s=n(263475),l=n(806915),o=n(915872),u=n(211965);function c({height:e,width:t,echartOptions:n,setDataMask:c,labelMap:d,labelMapB:p,groupby:h,groupbyB:m,selectedValues:f,formData:g,emitCrossFilters:v,seriesBreakdown:w,onContextMenu:y,xValueFormatter:b,xAxis:k,refs:I}){const[Z,S]=(0,r.useState)(!1),[x,E]=(0,r.useState)({}),[$,j]=(0,r.useState)({}),[D,A]=(0,r.useState)({}),{sliceJumpSetData:C}=(null==g?void 0:g.meta)||{},L=(0,r.useCallback)((e=>e<w),[w]),O=(e,t)=>{const n=Object.values(f||{});n.includes(e)?V(n.filter((t=>t!==e)),t):V([e],t)},V=(0,r.useCallback)(((e,t)=>{if(!v)return;const n=L(t)?h:m,r=L(t)?d:p,i=e.map((e=>null==r?void 0:r[e])).filter((e=>!!e));c({extraFormData:{filters:0===e.length?[]:[...n.map(((e,t)=>{const n=i.map((e=>e[t]));return null===n||void 0===n?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:n}}))]},filterState:{value:i.length?i:null,selectedValues:e.length?e:null}})}),[h,m,d,p,c,f]),F={click:e=>{const{seriesName:t,seriesIndex:n,componentType:r}=e;var i,a;"series"===r&&(C&&Array.isArray(C)&&C.length>0?(E({position:"absolute",left:`${null==(i=e.event)?void 0:i.offsetX}px`,top:`${null==(a=e.event)?void 0:a.offsetY}px`}),j({[g.xAxis]:e.name,[e.seriesId]:e.data[1]}),A({key:t,val:n}),setTimeout((()=>{S(!0)}),0)):O(t,n))},mouseout:()=>{l.aI.name=""},mouseover:e=>{l.aI.name=e.seriesName},contextmenu:e=>{if(y){e.event.stop();const{data:t,seriesIndex:n}=e;if(t){const r=e.event.event,s=[...e.name?[e.name]:[],...(L(n)?d:p)[e.seriesName]],l=[];k.type===i.we.time&&l.push({col:k.label===a.W3?g.granularitySqla:k.label,grain:g.timeGrainSqla,op:"==",val:t[0],formattedVal:b(t[0])}),[...k.type===i.we.category?[k.label]:[],...L(n)?g.groupby:g.groupbyB].forEach(((e,t)=>l.push({col:e,op:"==",val:s[t],formattedVal:String(s[t])}))),y(r.clientX,r.clientY,l)}}}},T=e=>{S(!1)};return(0,r.useEffect)((()=>(window.addEventListener("click",T),()=>{window.removeEventListener("click",T)})),[]),(0,u.tZ)(r.Fragment,null,(0,u.tZ)(s.Z,{refs:I,height:e,width:t,echartOptions:n,eventHandlers:F,selectedValues:f}),(0,u.tZ)(o.Z,{position:x,showDiv:Z,sliceJumpSetData:C,setShowDiv:S,clickProps:$,handleProps:D,handleDrillingIn:e=>{O(e.key,e.val)}}))}},263475:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(667294),i=n(751995),a=n(53552),s=n(211965);const l=i.iK.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function o({width:e,height:t,echartOptions:n,eventHandlers:i,zrEventHandlers:o,selectedValues:u={},refs:c},d){const p=(0,r.useRef)(null);c&&(c.divRef=p);const h=(0,r.useRef)(),m=(0,r.useMemo)((()=>Object.keys(u)||[]),[u]),f=(0,r.useRef)([]);(0,r.useImperativeHandle)(d,(()=>({getEchartInstance:()=>h.current}))),(0,r.useEffect)((()=>{p.current&&(h.current||(h.current=(0,a.S1)(p.current)),Object.entries(i||{}).forEach((([e,t])=>{var n,r;null==(n=h.current)||n.off(e),null==(r=h.current)||r.on(e,t)})),Object.entries(o||{}).forEach((([e,t])=>{var n,r;null==(n=h.current)||n.getZr().off(e),null==(r=h.current)||r.getZr().on(e,t)})),h.current.setOption(n,!0))}),[n,i,o]),(0,r.useEffect)((()=>{h.current&&(h.current.dispatchAction({type:"downplay",dataIndex:f.current.filter((e=>!m.includes(e)))}),m.length&&h.current.dispatchAction({type:"highlight",dataIndex:m}),h.current.dispatchAction({type:"hideTip"}),f.current=m)}),[m]);const g=(0,r.useCallback)((({width:e,height:t})=>{h.current&&h.current.resize({width:e,height:t})}),[]);return(0,r.useEffect)((()=>{if(!h.current)return;const e=()=>{h.current&&h.current.dispatchAction({type:"hideTip"})};return window.addEventListener("message",(t=>{"share-page-scroll"===t.data.type&&e()})),()=>{window.removeEventListener("message",e)}}),[h.current]),(0,r.useEffect)((()=>(g({width:e,height:t}),()=>{var e;return null==(e=h.current)?void 0:e.dispose()})),[]),(0,r.useLayoutEffect)((()=>{g({width:e,height:t})}),[e,t,g]),(0,s.tZ)(l,{ref:p,height:t,width:e})}const u=(0,r.forwardRef)(o)}}]);