"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[80616],{680616:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r(667294),c=r(263475),s=r(499381),u=r(211965);function i(e){const{height:t,width:r,echartOptions:i,setDataMask:a,labelMap:l,groupby:o,selectedValues:h,emitCrossFilters:d,refs:f}=e,p=(0,n.useCallback)((e=>{if(!d)return;const t=e.map((e=>l[e]));a({extraFormData:{filters:0===e.length?[]:o.map(((e,r)=>{const n=t.map((e=>e[r]));return null===n||void 0===n?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:n}}))},filterState:{value:t.length?t:null,selectedValues:e.length?e:null}})}),[o,l,a,h]),g=(0,s.C0)(e,p);return(0,u.tZ)(c.Z,{refs:f,height:t,width:r,echartOptions:i,eventHandlers:g,selectedValues:h})}},263475:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(667294),c=r(751995),s=r(53552),u=r(211965);const i=c.iK.div`
  height: ${({height:e})=>e};
  width: ${({width:e})=>e};
`;function a({width:e,height:t,echartOptions:r,eventHandlers:c,zrEventHandlers:a,selectedValues:l={},refs:o},h){const d=(0,n.useRef)(null);o&&(o.divRef=d);const f=(0,n.useRef)(),p=(0,n.useMemo)((()=>Object.keys(l)||[]),[l]),g=(0,n.useRef)([]);(0,n.useImperativeHandle)(h,(()=>({getEchartInstance:()=>f.current}))),(0,n.useEffect)((()=>{d.current&&(f.current||(f.current=(0,s.S1)(d.current)),Object.entries(c||{}).forEach((([e,t])=>{var r,n;null==(r=f.current)||r.off(e),null==(n=f.current)||n.on(e,t)})),Object.entries(a||{}).forEach((([e,t])=>{var r,n;null==(r=f.current)||r.getZr().off(e),null==(n=f.current)||n.getZr().on(e,t)})),f.current.setOption(r,!0))}),[r,c,a]),(0,n.useEffect)((()=>{f.current&&(f.current.dispatchAction({type:"downplay",dataIndex:g.current.filter((e=>!p.includes(e)))}),p.length&&f.current.dispatchAction({type:"highlight",dataIndex:p}),f.current.dispatchAction({type:"hideTip"}),g.current=p)}),[p]);const v=(0,n.useCallback)((({width:e,height:t})=>{f.current&&f.current.resize({width:e,height:t})}),[]);return(0,n.useEffect)((()=>{if(!f.current)return;const e=()=>{f.current&&f.current.dispatchAction({type:"hideTip"})};return window.addEventListener("message",(t=>{"share-page-scroll"===t.data.type&&e()})),()=>{window.removeEventListener("message",e)}}),[f.current]),(0,n.useEffect)((()=>(v({width:e,height:t}),()=>{var e;return null==(e=f.current)?void 0:e.dispose()})),[]),(0,n.useLayoutEffect)((()=>{v({width:e,height:t})}),[e,t,v]),(0,u.tZ)(i,{ref:d,height:t,width:e})}const l=(0,n.forwardRef)(a)},499381:(e,t,r)=>{r.d(t,{C0:()=>s});const n=(e,t)=>r=>{const{name:n}=r,c=Object.values(e);c.includes(n)?t(c.filter((e=>e!==n)),r):t([n],r)},c=(e,t,r)=>n=>{if(t){n.event.stop();const c=n.event.event,s=[];if(e.length>0){const t=r[n.name];e.forEach(((e,r)=>s.push({col:e,op:"==",val:t[r],formattedVal:String(t[r])})))}t(c.clientX,c.clientY,s)}},s=(e,t)=>{const{groupby:r,selectedValues:s,onContextMenu:u,labelMap:i}=e;return{click:n(s,t),contextmenu:c(r,u,i)}}}}]);